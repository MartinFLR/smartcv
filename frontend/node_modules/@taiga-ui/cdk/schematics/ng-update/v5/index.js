"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.updateToV5 = void 0;
const node_perf_hooks_1 = require("node:perf_hooks");
const schematics_1 = require("@angular-devkit/schematics");
const tasks_1 = require("@angular-devkit/schematics/tasks");
const ng_morph_1 = require("ng-morph");
const versions_1 = require("../../ng-add/constants/versions");
const get_execution_time_1 = require("../../utils/get-execution-time");
const migrate_tokens_1 = require("./steps/migrate-tokens/migrate-tokens");
const update_tsconfig_1 = require("./steps/migrate-tokens/update-tsconfig");
function main(options) {
    return (tree, context) => {
        (0, migrate_tokens_1.migrateTokens)(tree, options);
        (0, update_tsconfig_1.updateTsConfig)(tree, options);
        context.addTask(new tasks_1.NodePackageInstallTask());
    };
}
function updateToV5(options) {
    const t0 = node_perf_hooks_1.performance.now();
    !options['skip-logs'] &&
        (0, ng_morph_1.titleLog)(`\n\n${ng_morph_1.START_SYMBOL} Your packages will be updated to @taiga-ui/*@${versions_1.TAIGA_VERSION}\n`);
    return (0, schematics_1.chain)([
        main(options),
        () => {
            const executionTime = (0, get_execution_time_1.getExecutionTime)(t0, node_perf_hooks_1.performance.now());
            !options['skip-logs'] &&
                (0, ng_morph_1.titleLog)(`${ng_morph_1.FINISH_SYMBOL} We migrated packages to @taiga-ui/*@${versions_1.TAIGA_VERSION} in ${executionTime}. \n`);
        },
    ]);
}
exports.updateToV5 = updateToV5;
//# sourceMappingURL=index.js.map