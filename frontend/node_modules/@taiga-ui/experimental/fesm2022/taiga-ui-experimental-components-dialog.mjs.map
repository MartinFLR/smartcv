{"version":3,"file":"taiga-ui-experimental-components-dialog.mjs","sources":["../../../projects/experimental/components/dialog/dialog.component.ts","../../../projects/experimental/components/dialog/dialog.template.html","../../../projects/experimental/components/dialog/dialog.options.ts","../../../projects/experimental/components/dialog/dialog.service.ts","../../../projects/experimental/components/dialog/dialog.directive.ts","../../../projects/experimental/components/dialog/taiga-ui-experimental-components-dialog.ts"],"sourcesContent":["import {NgIf} from '@angular/common';\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    inject,\n    TemplateRef,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {takeUntilDestroyed, toSignal} from '@angular/core/rxjs-interop';\nimport {TUI_TRUE_HANDLER} from '@taiga-ui/cdk/constants';\nimport {TuiAnimated} from '@taiga-ui/cdk/directives/animated';\nimport {TuiAutoFocus} from '@taiga-ui/cdk/directives/auto-focus';\nimport {type TuiPopover} from '@taiga-ui/cdk/services';\nimport {TuiButton} from '@taiga-ui/core/components/button';\nimport {TUI_DIALOGS_CLOSE, TuiDialogCloseService} from '@taiga-ui/core/components/dialog';\nimport {TuiTitle} from '@taiga-ui/core/directives/title';\nimport {TUI_CLOSE_WORD, TUI_COMMON_ICONS} from '@taiga-ui/core/tokens';\nimport {TUI_HEADER_OPTIONS, TuiHeader} from '@taiga-ui/layout/components/header';\nimport {\n    injectContext,\n    PolymorpheusComponent,\n    PolymorpheusOutlet,\n    PolymorpheusTemplate,\n} from '@taiga-ui/polymorpheus';\nimport {\n    exhaustMap,\n    filter,\n    isObservable,\n    map,\n    merge,\n    type Observable,\n    of,\n    Subject,\n    switchMap,\n    take,\n} from 'rxjs';\n\nimport {type TuiDialogOptions} from './dialog.options';\n\nconst REQUIRED_ERROR = new Error('Required dialog was dismissed');\n\nfunction toObservable<T>(valueOrStream: Observable<T> | T): Observable<T> {\n    return isObservable(valueOrStream) ? valueOrStream : of(valueOrStream);\n}\n\n@Component({\n    standalone: true,\n    selector: 'tui-dialog',\n    imports: [NgIf, PolymorpheusOutlet, TuiAutoFocus, TuiButton, TuiHeader, TuiTitle],\n    templateUrl: './dialog.template.html',\n    styleUrls: ['./dialog.style.less'],\n    encapsulation: ViewEncapsulation.None,\n    // So we don't force OnPush on dialog content\n    // eslint-disable-next-line @angular-eslint/prefer-on-push-component-change-detection\n    changeDetection: ChangeDetectionStrategy.Default,\n    providers: [\n        TuiDialogCloseService,\n        {\n            provide: TUI_HEADER_OPTIONS,\n            useFactory: (): {size: string} => ({size: getSize(injectContext())}),\n        },\n    ],\n    hostDirectives: [TuiAnimated],\n    host: {\n        new: '',\n        '[attr.data-appearance]': 'context.appearance',\n        '[attr.data-size]': 'context.size',\n        '[class._closable]': 'context.closable',\n    },\n})\nexport class TuiDialogComponent<O, I> {\n    protected readonly close$ = new Subject<void>();\n    protected readonly close = toSignal(inject(TUI_CLOSE_WORD));\n    protected readonly icons = inject(TUI_COMMON_ICONS);\n    protected readonly context = injectContext<TuiPopover<TuiDialogOptions<I>, O>>();\n    protected readonly primitive =\n        !(this.context.content instanceof TemplateRef) &&\n        !(this.context.content instanceof PolymorpheusTemplate) &&\n        !(this.context.content instanceof PolymorpheusComponent);\n\n    protected readonly sub = merge(\n        this.close$.pipe(switchMap(() => toObservable(this.context.closable))),\n        inject(TuiDialogCloseService).pipe(\n            exhaustMap(() => toObservable(this.context.dismissible).pipe(take(1))),\n        ),\n        inject(TUI_DIALOGS_CLOSE).pipe(map(TUI_TRUE_HANDLER)),\n    )\n        .pipe(filter(Boolean), takeUntilDestroyed())\n        .subscribe(() => {\n            if (this.context.required) {\n                this.context.$implicit.error(REQUIRED_ERROR);\n            } else {\n                this.context.$implicit.complete();\n            }\n        });\n}\n\nfunction getSize({appearance, size}: TuiDialogOptions<unknown>): 'h3' | 'h4' | 'h5' {\n    if (appearance.includes('fullscreen')) {\n        return 'h3';\n    }\n\n    return size === 's' ? 'h5' : 'h4';\n}\n","<button\n    *ngIf=\"context.closable\"\n    size=\"s\"\n    tuiIconButton\n    type=\"button\"\n    class=\"t-close\"\n    [appearance]=\"context.appearance === 'fullscreen' ? 'action' : 'neutral'\"\n    [iconStart]=\"icons.close\"\n    [style.border-radius.%]=\"100\"\n    (click)=\"close$.next()\"\n    (mousedown.prevent.zoneless)=\"(0)\"\n>\n    {{ close() }}\n</button>\n\n<header\n    *ngIf=\"!primitive && context.label\"\n    tuiHeader\n>\n    <hgroup tuiTitle>\n        <h2\n            [id]=\"context.id\"\n            [innerHTML]=\"context.label\"\n        ></h2>\n    </hgroup>\n</header>\n\n<ng-container *polymorpheusOutlet=\"context.content as text; context: context\">\n    <header tuiHeader>\n        <hgroup tuiTitle>\n            <h2\n                [id]=\"context.id\"\n                [innerHTML]=\"context.label\"\n            ></h2>\n            <p [innerHTML]=\"text\"></p>\n        </hgroup>\n    </header>\n    <footer *ngIf=\"context.closable || context.dismissible\">\n        <button\n            size=\"m\"\n            tuiAutoFocus\n            tuiButton\n            type=\"button\"\n            (click)=\"context.$implicit.complete()\"\n        >\n            {{ context.data || 'OK' }}\n        </button>\n    </footer>\n</ng-container>\n","import {type TuiPopoverContext} from '@taiga-ui/cdk/services';\nimport {tuiCreateOptions} from '@taiga-ui/cdk/utils/di';\nimport {type TuiSizeL, type TuiSizeS} from '@taiga-ui/core/types';\nimport {type Observable} from 'rxjs';\n\n/**\n * Options for a dialog\n *\n * appearance - data-appearance attribute of the dialog ('taiga' by default)\n * closable - show close button (true by default)\n * data - arbitrary data for dialog\n * dismissible - close dialog by Esc button or click on overlay (true by default)\n * label - string title for the dialog ('' by default)\n * required - dismissing or closing dialog by X button throws (false by default)\n * size - size of the dialog ('m' by default)\n */\nexport interface TuiDialogOptions<I> {\n    readonly appearance: string;\n    readonly closable: Observable<boolean> | boolean;\n    readonly data: I extends void ? undefined : I;\n    readonly dismissible: Observable<boolean> | boolean;\n    readonly label: string;\n    readonly required: boolean;\n    readonly size: TuiSizeL | TuiSizeS;\n}\n\nexport interface TuiDialogContext<O = void, I = undefined>\n    extends TuiPopoverContext<O>,\n        TuiDialogOptions<I> {}\n\nexport const TUI_DIALOG_DEFAULT_OPTIONS: TuiDialogOptions<void> = {\n    appearance: 'taiga',\n    size: 'm',\n    required: false,\n    closable: true,\n    dismissible: true,\n    label: '',\n    data: undefined,\n};\n\nexport const [TUI_DIALOG_OPTIONS, tuiDialogOptionsProvider] = tuiCreateOptions(\n    TUI_DIALOG_DEFAULT_OPTIONS,\n);\n","import {inject, Injectable} from '@angular/core';\nimport {TuiPopoverService} from '@taiga-ui/cdk/services';\nimport {TUI_DIALOGS} from '@taiga-ui/core/components/dialog';\n\nimport {TuiDialogComponent} from './dialog.component';\nimport {TUI_DIALOG_OPTIONS, type TuiDialogOptions} from './dialog.options';\n\n@Injectable({\n    providedIn: 'root',\n    useFactory: () =>\n        new TuiDialogService(TUI_DIALOGS, TuiDialogComponent, inject(TUI_DIALOG_OPTIONS)),\n})\nexport class TuiDialogService extends TuiPopoverService<TuiDialogOptions<any>> {}\n","import {Directive} from '@angular/core';\nimport {TuiPopoverDirective} from '@taiga-ui/cdk/directives/popover';\nimport {tuiAsPopover} from '@taiga-ui/cdk/services';\n\nimport {type TuiDialogOptions} from './dialog.options';\nimport {TuiDialogService} from './dialog.service';\n\n@Directive({\n    standalone: true,\n    selector: 'ng-template[tuiDialog]',\n    inputs: ['options: tuiDialogOptions', 'open: tuiDialog'],\n    outputs: ['openChange: tuiDialogChange'],\n    providers: [tuiAsPopover(TuiDialogService)],\n})\nexport class TuiDialog<T> extends TuiPopoverDirective<TuiDialogOptions<T>> {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}