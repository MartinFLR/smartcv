import { DOCUMENT } from '@angular/common';
import { inject, Injectable } from '@angular/core';
import { tuiIsHTMLElement } from '@taiga-ui/cdk/utils/dom';
import { tuiGetNativeFocused } from '@taiga-ui/cdk/utils/focus';
import { BehaviorSubject, EMPTY, Observable } from 'rxjs';
import { TUI_SHEET_OPTIONS } from './sheet-options';
import * as i0 from "@angular/core";
/**
 * @deprecated: use {@link TuiSheetDialogService}
 * https://taiga-ui.dev/components/sheet-dialog
 */
class TuiSheetService {
    constructor() {
        this.doc = inject(DOCUMENT);
        this.options = inject(TUI_SHEET_OPTIONS);
        this.sheets$ = new BehaviorSubject([]);
    }
    open(content, options = {}) {
        return new Observable(($implicit) => {
            const completeWith = (result) => {
                $implicit.next(result);
                $implicit.complete();
            };
            const sheet = {
                ...this.options,
                ...options,
                content,
                completeWith,
                $implicit,
                scroll$: EMPTY,
            };
            const focused = tuiGetNativeFocused(this.doc);
            if (tuiIsHTMLElement(focused) && sheet.overlay) {
                focused.blur();
            }
            this.sheets$.next([...this.sheets$.value, sheet]);
            return () => {
                this.sheets$.next(this.sheets$.value.filter((item) => item !== sheet));
            };
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiSheetService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiSheetService, providedIn: 'root' }); }
}
export { TuiSheetService };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiSheetService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hlZXQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xlZ2FjeS9jb21wb25lbnRzL3NoZWV0L3NoZWV0LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxNQUFNLEVBQUUsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ2pELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLHlCQUF5QixDQUFDO0FBQ3pELE9BQU8sRUFBQyxtQkFBbUIsRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBRTlELE9BQU8sRUFBQyxlQUFlLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUd4RCxPQUFPLEVBQUMsaUJBQWlCLEVBQXVCLE1BQU0saUJBQWlCLENBQUM7O0FBRXhFOzs7R0FHRztBQUNILE1BR2EsZUFBZTtJQUg1QjtRQUlxQixRQUFHLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZCLFlBQU8sR0FBRyxNQUFNLENBQWtCLGlCQUFpQixDQUFDLENBQUM7UUFDdEQsWUFBTyxHQUFHLElBQUksZUFBZSxDQUE0QixFQUFFLENBQUMsQ0FBQztLQWdDaEY7SUE5QlUsSUFBSSxDQUNQLE9BQXlDLEVBQ3pDLFVBQW9DLEVBQUU7UUFFdEMsT0FBTyxJQUFJLFVBQVUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFO1lBQ2hDLE1BQU0sWUFBWSxHQUFHLENBQUMsTUFBUyxFQUFRLEVBQUU7Z0JBQ3JDLFNBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3ZCLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN6QixDQUFDLENBQUM7WUFDRixNQUFNLEtBQUssR0FBa0I7Z0JBQ3pCLEdBQUcsSUFBSSxDQUFDLE9BQU87Z0JBQ2YsR0FBRyxPQUFPO2dCQUNWLE9BQU87Z0JBQ1AsWUFBWTtnQkFDWixTQUFTO2dCQUNULE9BQU8sRUFBRSxLQUFLO2FBQ2pCLENBQUM7WUFDRixNQUFNLE9BQU8sR0FBRyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFFOUMsSUFBSSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsT0FBTyxFQUFFO2dCQUM1QyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7YUFDbEI7WUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUVsRCxPQUFPLEdBQUcsRUFBRTtnQkFDUixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQzNFLENBQUMsQ0FBQztRQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQzsrR0FsQ1EsZUFBZTttSEFBZixlQUFlLGNBRlosTUFBTTs7U0FFVCxlQUFlOzRGQUFmLGVBQWU7a0JBSDNCLFVBQVU7bUJBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtET0NVTUVOVH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7aW5qZWN0LCBJbmplY3RhYmxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7dHVpSXNIVE1MRWxlbWVudH0gZnJvbSAnQHRhaWdhLXVpL2Nkay91dGlscy9kb20nO1xuaW1wb3J0IHt0dWlHZXROYXRpdmVGb2N1c2VkfSBmcm9tICdAdGFpZ2EtdWkvY2RrL3V0aWxzL2ZvY3VzJztcbmltcG9ydCB7dHlwZSBQb2x5bW9ycGhldXNDb250ZW50fSBmcm9tICdAdGFpZ2EtdWkvcG9seW1vcnBoZXVzJztcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0LCBFTVBUWSwgT2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7dHlwZSBUdWlTaGVldH0gZnJvbSAnLi9zaGVldCc7XG5pbXBvcnQge1RVSV9TSEVFVF9PUFRJT05TLCB0eXBlIFR1aVNoZWV0T3B0aW9uc30gZnJvbSAnLi9zaGVldC1vcHRpb25zJztcblxuLyoqXG4gKiBAZGVwcmVjYXRlZDogdXNlIHtAbGluayBUdWlTaGVldERpYWxvZ1NlcnZpY2V9XG4gKiBodHRwczovL3RhaWdhLXVpLmRldi9jb21wb25lbnRzL3NoZWV0LWRpYWxvZ1xuICovXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBUdWlTaGVldFNlcnZpY2Uge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgZG9jID0gaW5qZWN0KERPQ1VNRU5UKTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG9wdGlvbnMgPSBpbmplY3Q8VHVpU2hlZXRPcHRpb25zPihUVUlfU0hFRVRfT1BUSU9OUyk7XG4gICAgcHVibGljIHJlYWRvbmx5IHNoZWV0cyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEFycmF5PFR1aVNoZWV0PGFueSwgYW55Pj4+KFtdKTtcblxuICAgIHB1YmxpYyBvcGVuPEc+KFxuICAgICAgICBjb250ZW50OiBQb2x5bW9ycGhldXNDb250ZW50PFR1aVNoZWV0PEc+PixcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxUdWlTaGVldE9wdGlvbnM+ID0ge30sXG4gICAgKTogT2JzZXJ2YWJsZTxHPiB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZSgoJGltcGxpY2l0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0ZVdpdGggPSAocmVzdWx0OiBHKTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgJGltcGxpY2l0Lm5leHQocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAkaW1wbGljaXQuY29tcGxldGUoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBzaGVldDogVHVpU2hlZXQ8YW55PiA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlV2l0aCxcbiAgICAgICAgICAgICAgICAkaW1wbGljaXQsXG4gICAgICAgICAgICAgICAgc2Nyb2xsJDogRU1QVFksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgZm9jdXNlZCA9IHR1aUdldE5hdGl2ZUZvY3VzZWQodGhpcy5kb2MpO1xuXG4gICAgICAgICAgICBpZiAodHVpSXNIVE1MRWxlbWVudChmb2N1c2VkKSAmJiBzaGVldC5vdmVybGF5KSB7XG4gICAgICAgICAgICAgICAgZm9jdXNlZC5ibHVyKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2hlZXRzJC5uZXh0KFsuLi50aGlzLnNoZWV0cyQudmFsdWUsIHNoZWV0XSk7XG5cbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGVldHMkLm5leHQodGhpcy5zaGVldHMkLnZhbHVlLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gc2hlZXQpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==