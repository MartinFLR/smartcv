import { InjectionToken, Optional, Self } from '@angular/core';
import { NgControl } from '@angular/forms';
import { tuiControlValue } from '@taiga-ui/cdk/observables';
import { map, of } from 'rxjs';
/**
 * Stream that emits calendar data change
 * @deprecated this should be rewritten in v5
 */
export const TUI_CALENDAR_DATE_STREAM = new InjectionToken(ngDevMode ? 'TUI_CALENDAR_DATE_STREAM' : '');
export function tuiDateStreamWithTransformer(transformer) {
    return {
        provide: TUI_CALENDAR_DATE_STREAM,
        deps: [
            [new Optional(), new Self(), NgControl],
            [new Optional(), transformer],
        ],
        useFactory: tuiControlValueFactory,
    };
}
function tuiControlValueFactory(control, transformer) {
    return control
        ? tuiControlValue(control).pipe(map((value) => transformer ? transformer?.fromControlValue(value) : value))
        : of(null);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItZGF0ZS1zdHJlYW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9raXQvdG9rZW5zL2NhbGVuZGFyLWRhdGUtc3RyZWFtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxjQUFjLEVBQUUsUUFBUSxFQUFpQixJQUFJLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDNUUsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBR3pDLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRCxPQUFPLEVBQUMsR0FBRyxFQUFtQixFQUFFLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFFOUM7OztHQUdHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxjQUFjLENBRXhELFNBQVMsQ0FBQyxDQUFDLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBRS9DLE1BQU0sVUFBVSw0QkFBNEIsQ0FDeEMsV0FBcUQ7SUFFckQsT0FBTztRQUNILE9BQU8sRUFBRSx3QkFBd0I7UUFDakMsSUFBSSxFQUFFO1lBQ0YsQ0FBQyxJQUFJLFFBQVEsRUFBRSxFQUFFLElBQUksSUFBSSxFQUFFLEVBQUUsU0FBUyxDQUFDO1lBQ3ZDLENBQUMsSUFBSSxRQUFRLEVBQUUsRUFBRSxXQUFXLENBQUM7U0FDaEM7UUFDRCxVQUFVLEVBQUUsc0JBQXNCO0tBQ3JDLENBQUM7QUFDTixDQUFDO0FBRUQsU0FBUyxzQkFBc0IsQ0FHM0IsT0FBeUIsRUFDekIsV0FBMkM7SUFFM0MsT0FBTyxPQUFPO1FBQ1YsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQ3pCLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQ1YsV0FBVyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFFLEtBQVcsQ0FDcEUsQ0FDSjtRQUNILENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbkIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW5qZWN0aW9uVG9rZW4sIE9wdGlvbmFsLCB0eXBlIFByb3ZpZGVyLCBTZWxmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7TmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge3R5cGUgVHVpVmFsdWVUcmFuc2Zvcm1lcn0gZnJvbSAnQHRhaWdhLXVpL2Nkay9jbGFzc2VzJztcbmltcG9ydCB7dHlwZSBUdWlEYXksIHR5cGUgVHVpRGF5UmFuZ2UsIHR5cGUgVHVpVGltZX0gZnJvbSAnQHRhaWdhLXVpL2Nkay9kYXRlLXRpbWUnO1xuaW1wb3J0IHt0dWlDb250cm9sVmFsdWV9IGZyb20gJ0B0YWlnYS11aS9jZGsvb2JzZXJ2YWJsZXMnO1xuaW1wb3J0IHttYXAsIHR5cGUgT2JzZXJ2YWJsZSwgb2Z9IGZyb20gJ3J4anMnO1xuXG4vKipcbiAqIFN0cmVhbSB0aGF0IGVtaXRzIGNhbGVuZGFyIGRhdGEgY2hhbmdlXG4gKiBAZGVwcmVjYXRlZCB0aGlzIHNob3VsZCBiZSByZXdyaXR0ZW4gaW4gdjVcbiAqL1xuZXhwb3J0IGNvbnN0IFRVSV9DQUxFTkRBUl9EQVRFX1NUUkVBTSA9IG5ldyBJbmplY3Rpb25Ub2tlbjxcbiAgICBPYnNlcnZhYmxlPFR1aURheSB8IFR1aURheVJhbmdlIHwgbnVsbD5cbj4obmdEZXZNb2RlID8gJ1RVSV9DQUxFTkRBUl9EQVRFX1NUUkVBTScgOiAnJyk7XG5cbmV4cG9ydCBmdW5jdGlvbiB0dWlEYXRlU3RyZWFtV2l0aFRyYW5zZm9ybWVyKFxuICAgIHRyYW5zZm9ybWVyOiBJbmplY3Rpb25Ub2tlbjxUdWlWYWx1ZVRyYW5zZm9ybWVyPGFueT4+LFxuKTogUHJvdmlkZXIge1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb3ZpZGU6IFRVSV9DQUxFTkRBUl9EQVRFX1NUUkVBTSxcbiAgICAgICAgZGVwczogW1xuICAgICAgICAgICAgW25ldyBPcHRpb25hbCgpLCBuZXcgU2VsZigpLCBOZ0NvbnRyb2xdLFxuICAgICAgICAgICAgW25ldyBPcHRpb25hbCgpLCB0cmFuc2Zvcm1lcl0sXG4gICAgICAgIF0sXG4gICAgICAgIHVzZUZhY3Rvcnk6IHR1aUNvbnRyb2xWYWx1ZUZhY3RvcnksXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gdHVpQ29udHJvbFZhbHVlRmFjdG9yeTxcbiAgICBUIGV4dGVuZHMgVHVpRGF5IHwgVHVpRGF5UmFuZ2UgfCBbVHVpRGF5LCBUdWlUaW1lIHwgbnVsbF0sXG4+KFxuICAgIGNvbnRyb2w6IE5nQ29udHJvbCB8IG51bGwsXG4gICAgdHJhbnNmb3JtZXI/OiBUdWlWYWx1ZVRyYW5zZm9ybWVyPFQ+IHwgbnVsbCxcbik6IE9ic2VydmFibGU8VCB8IG51bGw+IHwgbnVsbCB7XG4gICAgcmV0dXJuIGNvbnRyb2xcbiAgICAgICAgPyB0dWlDb250cm9sVmFsdWUoY29udHJvbCkucGlwZShcbiAgICAgICAgICAgICAgbWFwKCh2YWx1ZSkgPT5cbiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVyID8gdHJhbnNmb3JtZXI/LmZyb21Db250cm9sVmFsdWUodmFsdWUpIDogKHZhbHVlIGFzIFQpLFxuICAgICAgICAgICAgICApLFxuICAgICAgICAgIClcbiAgICAgICAgOiBvZihudWxsKTtcbn1cbiJdfQ==