
<p>{{coverLetterForm.getRawValue() | json}}</p>
<fieldset [formGroup]="coverLetterForm" class="flex flex-col gap-6">
  <div class="flex flex-col gap-2">
    <h2 class="text-xl font-semibold text-gray-800">
      Generá tu carta de presentacion
    </h2>
    <p class="text-sm text-gray-600">
      La IA va a analizar lo que tenés ahora en el CV y va a generar una cover
      letter personalizada para que le puedas enviar a los recruiters.
    </p>
  </div>

  <h3 class="text-sm font-semibold text-gray-800">Campos opcionales</h3>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <tui-textfield>
      <label tuiLabel>Nombre del Reclutador/a</label>
      <input
        tuiTextfield
        formControlName="recruiterName"
        placeholder="Ej: Ana Pérez"
      />
    </tui-textfield>
    <tui-textfield>
      <label tuiLabel>Nombre de la Empresa</label>
      <input
        tuiTextfield
        formControlName="companyName"
        placeholder="Ej: Mercado Libre"
      />
    </tui-textfield>
  </div>

  <fieldset  class="flex flex-col gap-2 py-2" >
    <label tuiLabel class="text-sm font-medium text-gray-700"
    >Tono de la carta</label
    >
    <div tuiItemGroup   class="flex flex-wrap gap-2">
      @for (tone of tones; track $index) {
        <label
          tuiChip
          [iconStart]="tone.icon"
          class="cursor-pointer"
          [appearance]="tone.value === coverLetterForm.controls.tone.value ? 'accent' : 'neutral'"
        >
          <input
            type="radio"
            formControlName="tone"
            tuiChip
            appearance=""
            [value]="tone.value"
            class="sr-only"
          />
          {{ tone.name }}
        </label>
      }
    </div>
  </fieldset>
</fieldset>

<fieldset [formGroup]="iaForm()" class="flex flex-col gap-6">
  <tui-textfield>
    <label tuiLabel>Pegá acá la descripción del puesto (Job Description)</label>
    <textarea
      tuiTextarea
      formControlName="jobDescription"
      [min]="8"
      [max]="10"
    ></textarea>
  </tui-textfield>

</fieldset>
<div class="mt-6">
  <button
    tuiButton
    type="button"
    class="w-full sm:w-auto"
    [loading]="isLoading()"
    [disabled]="iaForm().invalid"
    (click)="generateCoverLetter()"
  >
    Generar carta
  </button>
</div>

@if (isLoading() ) {
  <div class="mt-8 flex flex-col gap-4">
    <h3 class="text-lg font-semibold text-gray-800">
      Tu carta de presentación generada
    </h3>

    <tui-loader [showLoader]="isLoading()" class="w-full">
      <tui-textfield>
        <textarea
          tuiTextarea
          [min]="15"
          [max]="25"
        >
          {{generatedLetter()}}
        </textarea>
        <tui-icon
          icon="@tui.copy"
          tuiCopy
        />
      </tui-textfield>

    </tui-loader>
  </div>
}
