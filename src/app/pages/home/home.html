<div class="max-w-8xl md:px-8 mx-auto justify-center grid grid-cols-1 md:grid-cols-12 gap-6 p-4">

  <div class="md:col-span-6 flex flex-col gap-6">
    <!-- Para texto
    <p>{{this.iaForm.getRawValue() | json}}</p>
    <p>{{this.cvForm.getRawValue() | json}}</p>
    -->
    <div class="p-6 border rounded-lg shadow-sm bg-white">
      <tui-tabs-with-more
        [itemsLimit]="6"
        [(activeItemIndex)]="activeTab"
        tuiFade>
        <button
          *tuiItem
          iconStart="@tui.user"
          tuiTab>
          Personal
        </button>
        <button
          *tuiItem
          iconStart="@tui.book-open"
          tuiTab>
          Educación
        </button>
        <button
          *tuiItem
          iconStart="@tui.briefcase"
          tuiTab>
          Experiencia
        </button>
        <button
          *tuiItem
          iconStart="@tui.folder"
          tuiTab>
          Proyectos
        </button>
        <button
          *tuiItem
          iconStart="@tui.code"
          tuiTab>
          Habilidades
        </button>
        <button
          *tuiItem
          iconStart="@tui.sparkles"
          tuiTab>
          IA
        </button>
        <button
          *tuiItem
          iconStart="@tui.filter"
          tuiTab>
          ATS
        </button>
        <button
          *tuiItem
          iconStart="@tui.notepad-text"
          tuiTab>
          Carta de Presentación
        </button>
      </tui-tabs-with-more>


      <form [formGroup]="cvForm" class="flex flex-col gap-6 pt-6">
        @switch (activeTab()) {
          @case (0) {
            <app-personal-info
              [personalInfoGroup]="personalInfoGroup"
            />
          }
          @case (1) {
            <app-education-section
              [educationForms]="educationForms"
              (add)="addEducation()"
              (remove)="removeEducation($event)"
            />
          }
          @case (2) {
            <app-experience-section
              [experienceForms]="experienceForms"
              (add)="addExperience()"
              (remove)="removeExperience($event)"
            />
          }
          @case (3) {
            <app-projects-section
              [projectForms]="projectForms"
              (add)="addProject()"
              (remove)="removeProject($event)"
            />
          }
          @case (4) {
            <app-skills-section
              [skillsForms]="skillsForms"
              (addSkillGroup)="addSkill()"
              (removeSkillGroup)="removeSkill($event)"
              (addCert)="addCertification($event)"
              (removeCert)="removeCertification($event)"
            />
          }
          @case (5) {
            <app-ia-section
              [iaForm]="iaForm"
              [isLoading]="isLoading()"
              (optimize)="optimizarCv()"
            />
          }
          @case (6) {
            <app-ats-section
              [isLoading]="isLoading()"
              [score]="80"
            />
          }
          @case (7) {
            <app-cover-letter-section
              [iaForm]="iaForm"
              [cvForm]="cvForm"
            />
          }
        }
      </form>
    </div>

    <app-actions
      [isLoading]="isLoading()"
      [isCvValid]="cvForm.valid"
      (save)="saveCv()"
      (download)="downloadPdf()"
      (clear)="clearCv()"
    />
  </div>

  <div class="md:col-span-6 md:sticky md:top-8 h-full">
    <app-dummy-view
      [cvPreview]="cvPreview()"
      [hasEducation]="hasEducation()"
      [hasExperience]="hasExperience()"
      [hasSkills]="hasSkills()"
      [hasProjects]="hasProjects()"
    />
  </div>
</div>
