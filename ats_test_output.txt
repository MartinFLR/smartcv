
> nx run frontend:test --test-file apps/frontend/src/app/features/cv/components/ats-section/ats-section.spec.ts

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [0m[7m[37m frontend [39m[27m[0m [2mapps/frontend/src/app/features/cv/components/ats-section/[22m[1mats-section.spec.ts[22m
  ATSSection
    [32mâœ“[39m [2mshould create (239 ms)[22m
    File Processing (processFile)
      [31mâœ•[39m [2mshould accept valid PDF files (69 ms)[22m
      [31mâœ•[39m [2mshould reject non-PDF files (53 ms)[22m
      [31mâœ•[39m [2mshould clear file when removeFile is called (46 ms)[22m
    Score Calculation (calculateAtsScore)
      [31mâœ•[39m [2mshould call analysis with correct FormData when file is present (44 ms)[22m
      [31mâœ•[39m [2mshould show alert warning if no file is selected (45 ms)[22m
      [31mâœ•[39m [2mshould handle API errors gracefully (41 ms)[22m
    Computed Signals (View Logic)
      [31mâœ•[39m [2mshould calculate score color correctly based on matchScore (47 ms)[22m
      [31mâœ•[39m [2mshould process analyzed sections correctly (86 ms)[22m
      [31mâœ•[39m [2mshould return empty array if no response data (48 ms)[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º File Processing (processFile) â€º should accept valid PDF files[39m[22m
    TypeError: Cannot read properties of undefined (reading 'setValue')
[2m[22m
[2m    [0m [90m 74 |[39m[22m
[2m     [90m 75 |[39m       [90m// Simulamos la selecciÃ³n del archivo a travÃ©s del control[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 76 |[39m       component[[32m'control'[39m][33m.[39msetValue(file)[33m;[39m[22m
[2m     [90m    |[39m                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 77 |[39m[22m
[2m     [90m 78 |[39m       [90m// processFile usa queueMicrotask, necesitamos esperar[39m[22m
[2m     [90m 79 |[39m       tick()[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:76:28[22m[2m[22m
[2m      [2mat fakeAsyncFn ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:1794:30)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º File Processing (processFile) â€º should reject non-PDF files[39m[22m
    TypeError: Cannot read properties of undefined (reading 'clearValidators')
[2m[22m
[2m    [0m [90m 85 |[39m       [36mconst[39m file [33m=[39m [36mnew[39m [33mFile[39m([[32m'dummy content'[39m][33m,[39m [32m'image.png'[39m[33m,[39m { type[33m:[39m [32m'image/png'[39m })[33m;[39m[22m
[2m     [90m 86 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 87 |[39m       component[[32m'control'[39m][33m.[39mclearValidators()[33m;[39m[22m
[2m     [90m    |[39m                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 88 |[39m       component[[32m'control'[39m][33m.[39mupdateValueAndValidity({ emitEvent[33m:[39m [36mfalse[39m })[33m;[39m[22m
[2m     [90m 89 |[39m[22m
[2m     [90m 90 |[39m       [36mconst[39m failedSpy [33m=[39m jest[33m.[39mspyOn(component[[32m'failedFiles$'[39m][33m,[39m [32m'next'[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:87:28[22m[2m[22m
[2m      [2mat fakeAsyncFn ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:1794:30)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º File Processing (processFile) â€º should clear file when removeFile is called[39m[22m
    TypeError: Cannot read properties of undefined (reading 'set')
[2m[22m
[2m    [0m [90m 101 |[39m       [90m// Arrange[39m[22m
[2m     [90m 102 |[39m       [36mconst[39m file [33m=[39m [36mnew[39m [33mFile[39m([[32m''[39m][33m,[39m [32m'cv.pdf'[39m[33m,[39m { type[33m:[39m [32m'application/pdf'[39m })[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 103 |[39m       component[[32m'cvFile'[39m][33m.[39m[36mset[39m(file)[33m;[39m[22m
[2m     [90m     |[39m                           [31m[1m^[22m[2m[39m[22m
[2m     [90m 104 |[39m       component[[32m'control'[39m][33m.[39msetValue(file)[33m;[39m[22m
[2m     [90m 105 |[39m[22m
[2m     [90m 106 |[39m       [90m// Act[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:103:27[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Score Calculation (calculateAtsScore) â€º should call analysis with correct FormData when file is present[39m[22m
    TypeError: Cannot read properties of undefined (reading 'set')
[2m[22m
[2m    [0m [90m 117 |[39m       [90m// Arrange[39m[22m
[2m     [90m 118 |[39m       [36mconst[39m file [33m=[39m [36mnew[39m [33mFile[39m([[32m'content'[39m][33m,[39m [32m'my-cv.pdf'[39m[33m,[39m { type[33m:[39m [32m'application/pdf'[39m })[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m       component[[32m'cvFile'[39m][33m.[39m[36mset[39m(file)[33m;[39m[22m
[2m     [90m     |[39m                           [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m[22m
[2m     [90m 121 |[39m       [90m// Mockeamos la respuesta exitosa del servicio[39m[22m
[2m     [90m 122 |[39m       atsSectionServiceMock[33m.[39mgetAtsScore[33m.[39mmockReturnValue([36mof[39m([33mMOCK_CV_ATS_RESPONSE[39m))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:119:27[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Score Calculation (calculateAtsScore) â€º should show alert warning if no file is selected[39m[22m
    TypeError: Cannot read properties of undefined (reading 'set')
[2m[22m
[2m    [0m [90m 137 |[39m     it([32m'should show alert warning if no file is selected'[39m[33m,[39m () [33m=>[39m {[22m
[2m     [90m 138 |[39m       [90m// Arrange[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 139 |[39m       component[[32m'cvFile'[39m][33m.[39m[36mset[39m([36mnull[39m)[33m;[39m[22m
[2m     [90m     |[39m                           [31m[1m^[22m[2m[39m[22m
[2m     [90m 140 |[39m[22m
[2m     [90m 141 |[39m       [90m// Act[39m[22m
[2m     [90m 142 |[39m       component[33m.[39mcalculateAtsScore()[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:139:27[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Score Calculation (calculateAtsScore) â€º should handle API errors gracefully[39m[22m
    TypeError: Cannot read properties of undefined (reading 'set')
[2m[22m
[2m    [0m [90m 155 |[39m       [90m// Arrange[39m[22m
[2m     [90m 156 |[39m       [36mconst[39m file [33m=[39m [36mnew[39m [33mFile[39m([[32m''[39m][33m,[39m [32m'cv.pdf'[39m[33m,[39m { type[33m:[39m [32m'application/pdf'[39m })[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 157 |[39m       component[[32m'cvFile'[39m][33m.[39m[36mset[39m(file)[33m;[39m[22m
[2m     [90m     |[39m                           [31m[1m^[22m[2m[39m[22m
[2m     [90m 158 |[39m[22m
[2m     [90m 159 |[39m       atsSectionServiceMock[33m.[39mgetAtsScore[33m.[39mmockReturnValue(throwError(() [33m=>[39m [36mnew[39m [33mError[39m([32m'API Error'[39m)))[33m;[39m[22m
[2m     [90m 160 |[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:157:27[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Computed Signals (View Logic) â€º should calculate score color correctly based on matchScore[39m[22m
    TypeError: component.scoreColor is not a function
[2m[22m
[2m    [0m [90m 175 |[39m       responseSignal[33m.[39m[36mset[39m([36mnull[39m)[33m;[39m[22m
[2m     [90m 176 |[39m       fixture[33m.[39mdetectChanges()[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 177 |[39m       expect(component[[32m'scoreColor'[39m]())[33m.[39mtoContain([32m'support-08'[39m)[33m;[39m [90m// Gris/Default[39m[22m
[2m     [90m     |[39m                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 178 |[39m[22m
[2m     [90m 179 |[39m       [90m// Caso: Score bajo (<50)[39m[22m
[2m     [90m 180 |[39m       responseSignal[33m.[39m[36mset[39m({ [33m...[39m[33mMOCK_CV_ATS_RESPONSE[39m[33m,[39m matchScore[33m:[39m [35m30[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:177:37[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Computed Signals (View Logic) â€º should process analyzed sections correctly[39m[22m
    TypeError: component.analyzedSections is not a function
[2m[22m
[2m    [0m [90m 199 |[39m[22m
[2m     [90m 200 |[39m       [90m// Act[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 201 |[39m       [36mconst[39m sections [33m=[39m component[[32m'analyzedSections'[39m]()[33m;[39m[22m
[2m     [90m     |[39m                                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 202 |[39m[22m
[2m     [90m 203 |[39m       [90m// Assert[39m[22m
[2m     [90m 204 |[39m       expect(sections[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:201:53[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1m[31m  [1mâ— [22m[1mATSSection â€º Computed Signals (View Logic) â€º should return empty array if no response data[39m[22m
    TypeError: component.analyzedSections is not a function
[2m[22m
[2m    [0m [90m 212 |[39m       responseSignal[33m.[39m[36mset[39m([36mnull[39m)[33m;[39m[22m
[2m     [90m 213 |[39m       fixture[33m.[39mdetectChanges()[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 214 |[39m       expect(component[[32m'analyzedSections'[39m]())[33m.[39mtoEqual([])[33m;[39m[22m
[2m     [90m     |[39m                                           [31m[1m^[22m[2m[39m[22m
[2m     [90m 215 |[39m     })[33m;[39m[22m
[2m     [90m 216 |[39m   })[33m;[39m[22m
[2m     [90m 217 |[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat [22m[2m[0m[36msrc/app/features/cv/components/ats-section/ats-section.spec.ts[39m[0m[2m:214:43[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:410:32)[22m[2m[22m
[2m      [2mat ProxyZoneSpec.onInvoke ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:2219:43)[22m[2m[22m
[2m      [2mat _ZoneDelegate.invoke ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:409:38)[22m[2m[22m
[2m      [2mat ZoneImpl.run ([22m[2m../../node_modules/zone.js/bundles/zone.umd.js[2m:145:47)[22m[2m[22m
[2m      [2mat Object.wrappedFunc ([22m[2m../../node_modules/zone.js/bundles/zone-testing.umd.js[2m:449:38)[22m[2m[22m
[1mTest Suites: [22m[1m[31m1 failed[39m[22m, 1 total
[1mTests:       [22m[1m[31m9 failed[39m[22m, [1m[32m1 passed[39m[22m, 10 total
[1mSnapshots:   [22m0 total
[1mTime:[22m        3.762 s, estimated 17 s
[2mRan all test suites[22m[2m matching [22mapps/frontend/src/app/features/cv/components/ats-section/ats-section.spec.ts[2m.[22m



 NX   Running target test for project frontend failed

Failed tasks:

- frontend:test

Hint: run the command with --verbose for more details.

